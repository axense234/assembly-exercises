     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  ; declare the EntryPoint (a label defining the very first instruction of the program)
     4                                  global start        
     5                                  
     6                                  ; declare external functions needed by our program
     7                                  extern exit               ; tell nasm that exit exists even if we won't be defining it
     8                                  import exit msvcrt.dll    ; exit is a function that ends the calling process. It is defined in msvcrt.dll
     9                                                            ; msvcrt.dll contains exit, printf and all the other important C-runtime specific functions
    10                                  
    11                                  ; our data is declared here (the variables needed by our program)
    12                                  
    13                                  ; Two byte strings S1 and S2 are given. Obtain the string D by concatenating the elements of S1 from the left hand side to the right hand side and the elements of S2 from the right hand side to the left hand side.
    14                                  
    15                                  ; for int i = 0, int j = LEN_S2, i < len_s2 + len_s1, ++i
    16                                  ;    if c > 0:
    17                                  ;       d += s1[i]
    18                                  ;       c--;
    19                                  ;    else:
    20                                  ;       d += s2[j]
    21                                  ;       j--;
    22                                  
    23                                  segment data use32 class=data
    24                                      ; ...
    25                                      LEN_S1 equ 4
    26                                      LEN_S2 equ 3
    27 00000000 01020304                    S1 db 1, 2, 3, 4
    28 00000004 050607                      S2 db 5, 6, 7
    29 00000007 00<rept>                    D times LEN_S1 + LEN_S2 db 0
    30                                      
    31                                  
    32                                  ; our code starts here
    33                                  segment code use32 class=code
    34                                      ; i = eax
    35                                      ; j = edx
    36                                      ; c = cl
    37                                      start:
    38                                          for_init:
    39 00000000 B800000000                          mov eax, 0
    40 00000005 BA02000000                          mov edx, LEN_S2 - 1
    41 0000000A B104                                mov cl, LEN_S1
    42                                          for_cond:
    43 0000000C 83F807                              cmp eax, LEN_S2 + LEN_S1
    44 0000000F 7D27                                jge for_end
    45                                          for_body:
    46                                          
    47                                              if_cond:
    48                                                  ; c > 0
    49 00000011 80F900                                  cmp byte cl, 0
    50 00000014 7E10                                    jle if_cond_false
    51                                            
    52                                              ; d = 1, 2, 3, 4
    53                                              if_cond_true:
    54                                                  ; bl = s1[i]
    55 00000016 8A98[00000000]                          mov bl, [S1 + eax]
    56                                                  
    57                                                  ; d += s1[i]
    58 0000001C 8898[07000000]                          mov [D + eax], bl;
    59                                                  
    60 00000022 FEC9                                    dec byte cl
    61                                                  
    62 00000024 EB0F                                    jmp for_post
    63                                              
    64                                              ; d = 1, 2, 3, 4, 7, 6, 5
    65                                              if_cond_false:
    66                                                  ; bl = s2[len_s2 - i]
    67 00000026 8A9A[04000000]                          mov bl, [S2 + edx]
    68                                                  
    69                                                  ; s1 at the next pos starting from it's end
    70 0000002C 8898[07000000]                          mov [D + eax], bl
    71 00000032 4A                                      dec edx
    72                                                  
    73 00000033 EB00                                    jmp for_post
    74                                             
    75                                          for_post:
    76 00000035 40                                  inc eax
    77 00000036 EBD4                                jmp for_cond
    78                                          for_end:
    79                                          
    80 00000038 8B0D[07000000]                  mov ecx, [D]
    81                                      
    82                                          ; exit(0)
    83 0000003E 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    84 00000040 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
